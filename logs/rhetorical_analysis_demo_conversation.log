2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] --- Début Nouveau Run ---
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] Type de llm_service: <class 'semantic_kernel.connectors.ai.open_ai.services.open_ai_chat_completion.OpenAIChatCompletion'>
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] Attributs de llm_service: ['MODEL_PROVIDER_NAME', 'SUPPORTS_FUNCTION_CALLING', '__abstractmethods__', '__annotations__', '__class__', '__class_getitem__', '__class_vars__', '__copy__', '__deepcopy__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__fields__', '__fields_set__', '__format__', '__ge__', '__get_pydantic_core_schema__', '__get_pydantic_json_schema__', '__getattr__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__pretty__', '__private_attributes__', '__pydantic_complete__', '__pydantic_core_schema__', '__pydantic_custom_init__', '__pydantic_decorators__', '__pydantic_extra__', '__pydantic_fields_set__', '__pydantic_generic_metadata__', '__pydantic_init_subclass__', '__pydantic_parent_namespace__', '__pydantic_post_init__', '__pydantic_private__', '__pydantic_root_model__', '__pydantic_serializer__', '__pydantic_validator__', '__reduce__', '__reduce_ex__', '__repr__', '__repr_args__', '__repr_name__', '__repr_str__', '__rich_repr__', '__setattr__', '__setstate__', '__signature__', '__sizeof__', '__slots__', '__str__', '__subclasshook__', '__weakref__', '_abc_impl', '_calculate_keys', '_check_frozen', '_copy_and_set_values', '_create_chat_message_content', '_create_streaming_chat_message_content', '_create_streaming_text_content', '_create_text_content', '_get_ai_model_id', '_get_function_call_from_chat_choice', '_get_metadata_from_chat_choice', '_get_metadata_from_chat_response', '_get_metadata_from_streaming_chat_response', '_get_metadata_from_text_choice', '_get_metadata_from_text_response', '_get_tool_calls_from_chat_choice', '_get_value', '_handle_structured_output', '_inner_get_chat_message_contents', '_inner_get_streaming_chat_message_contents', '_inner_get_streaming_text_contents', '_inner_get_text_contents', '_iter', '_prepare_chat_history_for_request', '_process_function_call', '_reset_function_choice_settings', '_send_audio_to_text_request', '_send_completion_request', '_send_embedding_request', '_send_request', '_send_text_to_audio_request', '_send_text_to_image_request', '_start_auto_function_invocation_activity', '_update_function_choice_settings_callback', '_verify_function_choice_settings', '_yield_function_result_messages', 'ai_model_id', 'ai_model_type', 'client', 'completion_tokens', 'construct', 'copy', 'dict', 'from_dict', 'from_orm', 'get_chat_message_content', 'get_chat_message_contents', 'get_prompt_execution_settings_class', 'get_prompt_execution_settings_from_settings', 'get_streaming_chat_message_content', 'get_streaming_chat_message_contents', 'get_streaming_text_content', 'get_streaming_text_contents', 'get_text_content', 'get_text_contents', 'instantiate_prompt_execution_settings', 'instruction_role', 'json', 'model_computed_fields', 'model_config', 'model_construct', 'model_copy', 'model_dump', 'model_dump_json', 'model_extra', 'model_fields', 'model_fields_set', 'model_json_schema', 'model_parametrized_name', 'model_post_init', 'model_rebuild', 'model_validate', 'model_validate_json', 'model_validate_strings', 'parse_file', 'parse_obj', 'parse_raw', 'prompt_tokens', 'schema', 'schema_json', 'service_id', 'service_url', 'store_usage', 'to_dict', 'total_tokens', 'update_forward_refs', 'validate']
2025-06-05 22:46:41 [WARNING] [Orchestration.Run.8899] Le service LLM ne supporte pas add_chat_hook_handler. Le RawResponseLogger ne sera pas actif.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] Utilisation du service LLM fourni: ID='global_llm_service'
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 1. Création instance état locale...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Instance état locale créée (id: 2113637270672) avec texte (longueur: 527).
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 2. Création instance StateManagerPlugin locale...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Instance StateManagerPlugin locale créée (id: 2113195055936).
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 3. Création Kernel local...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Service LLM 'global_llm_service' ajouté.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Plugin 'StateManager' (local) ajouté.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 4. Création et configuration des instances d'agents refactorés...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Agent ProjectManagerAgent_Refactored instancié et configuré.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Agent InformalAnalysisAgent_Refactored instancié et configuré.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Agent PropositionalLogicAgent_Refactored instancié et configuré.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Agent ExtractAgent_Refactored instancié et configuré.
2025-06-05 22:46:41 [DEBUG] [Orchestration.Run.8899]    Plugins enregistrés dans local_kernel après setup des agents: ['StateManager', 'ProjectManagerAgent_Refactored', 'InformalAnalyzer', 'PropositionalLogicAgent_Refactored', 'ExtractNativePlugin', 'ExtractAgent_Refactored']
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 5. Création des instances ChatCompletionAgent pour AgentGroupChat...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Settings LLM pour ChatCompletionAgent (auto function call): enable_kernel_functions=True maximum_auto_invoke_attempts=5 filters=None type_=<FunctionChoiceType.AUTO: 'auto'>
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Instances ChatCompletionAgent créées pour AgentGroupChat: ['ProjectManagerAgent', 'InformalAnalysisAgent', 'PropositionalLogicAgent', 'ExtractAgent'].
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 6. Création instances stratégies locales...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Instances stratégies créées (Terminaison id: 2113557401408, Sélection id: 2113557401168).
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 7. Création instance AgentGroupChat locale...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Instance AgentGroupChat locale créée (id: 2113557401088).
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] 8. Initialisation historique et lancement invoke...
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] Message initial (Utilisateur): Bonjour à tous. Le texte à analyser est :
'''
Le réchauffement climatique est un sujet complexe. Certains affirment qu'il s'agit d'un mythe, citant par exemple des hivers froids comme preuve. D'autres soutiennent que des mesures drastiques sont nécessaires immédiatement pour éviter une catastrophe planétaire. Il est également courant d'entendre que les scientifiques qui alertent sur ce danger sont financièrement motivés, ce qui mettrait en doute leurs conclusions. Face à ces arguments, il est crucial d'analyser les faits avec rigueur et de déconstruire les sophismes.
'''
ProjectManagerAgent, merci de définir les premières tâches d'analyse en suivant la séquence logique.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899]    Message initial ajouté à l'historique interne de AgentGroupChat.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] >>> Début boucle invocation AgentGroupChat <<<
2025-06-05 22:46:41 [ERROR] [Orchestration.Run.8899] Erreur majeure exécution conversation: ("<class 'semantic_kernel.connectors.ai.open_ai.services.open_ai_chat_completion.OpenAIChatCompletion'> service failed to complete the prompt", AuthenticationError("Error code: 401 - {'error': {'message': 'OpenAI-Organization header should match organization for API key', 'type': 'invalid_request_error', 'param': None, 'code': 'mismatched_organization'}}"))
Traceback (most recent call last):
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\connectors\ai\open_ai\services\open_ai_handler.py", line 87, in _send_completion_request
    response = await self.client.chat.completions.create(**settings_dict)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\openai\resources\chat\completions\completions.py", line 2028, in create
    return await self._post(
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\openai\_base_client.py", line 1748, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\openai\_base_client.py", line 1555, in request
    raise self._make_status_error_from_response(err.response) from None
openai.AuthenticationError: Error code: 401 - {'error': {'message': 'OpenAI-Organization header should match organization for API key', 'type': 'invalid_request_error', 'param': None, 'code': 'mismatched_organization'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\2025-Epita-Intelligence-Symbolique-4\argumentation_analysis\orchestration\analysis_runner.py", line 203, in run_analysis_conversation
    async for message in local_group_chat.invoke():
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\agents\group_chat\agent_group_chat.py", line 156, in invoke
    async for message in super().invoke_agent(selected_agent):
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\agents\group_chat\agent_chat.py", line 149, in invoke_agent
    async for is_visible, message in channel.invoke(agent):
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\agents\channels\chat_history_channel.py", line 65, in invoke
    async for response in agent.invoke(
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\utils\telemetry\agent_diagnostics\decorators.py", line 39, in wrapper_decorator
    async for response in invoke_func(*args, **kwargs):
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\agents\chat_completion\chat_completion_agent.py", line 328, in invoke
    async for response in self._inner_invoke(
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\agents\chat_completion\chat_completion_agent.py", line 487, in _inner_invoke
    responses = await chat_completion_service.get_chat_message_contents(
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\connectors\ai\chat_completion_client_base.py", line 139, in get_chat_message_contents
    completions = await self._inner_get_chat_message_contents(chat_history, settings)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\utils\telemetry\model_diagnostics\decorators.py", line 112, in wrapper_decorator
    return await completion_func(*args, **kwargs)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\connectors\ai\open_ai\services\open_ai_chat_completion_base.py", line 88, in _inner_get_chat_message_contents
    response = await self._send_request(settings)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\connectors\ai\open_ai\services\open_ai_handler.py", line 59, in _send_request
    return await self._send_completion_request(settings)
  File "C:\Users\MYIA\miniconda3\envs\projet-is\lib\site-packages\semantic_kernel\connectors\ai\open_ai\services\open_ai_handler.py", line 104, in _send_completion_request
    raise ServiceResponseException(
semantic_kernel.exceptions.service_exceptions.ServiceResponseException: ("<class 'semantic_kernel.connectors.ai.open_ai.services.open_ai_chat_completion.OpenAIChatCompletion'> service failed to complete the prompt", AuthenticationError("Error code: 401 - {'error': {'message': 'OpenAI-Organization header should match organization for API key', 'type': 'invalid_request_error', 'param': None, 'code': 'mismatched_organization'}}"))
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] Fin analyse. Durée totale: 0.49 sec.
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] État final JVM: (JVM active)
2025-06-05 22:46:41 [INFO] [Orchestration.Run.8899] --- Fin Run_8899 ---
